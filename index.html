<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="stylesheet.css" type="text/css"><!--Add Styling to make drop zone more visible-->
	
	<!-- EasyFileReader External Script-->
	<script src = "EasyFileReader.js"></script>

	<!-- EasyListener External Script-->
	<script src="EasyListener.js"></script>
</head>
<body>


  <! Basic HTML for Project>
  <input type="file" id="fileButton" name="fileButton"  multiple />
  <div id="drop_zone">Drop files here</div>
  <div id="textout"></div>
  <div id="previewBox"></div>
  <!-- Local Script-->
  <script>

  // List of Allowable File Types (Optional)
 // Add or remove fileReader supported file types as needed; if this is set to null then any file type can be potentially used

const genImgFromSrc = (src) => {
	const img = document.createElement('img')
	img.classList.add('boxed')
	img.src = src
	return img
}	

const preview = (src) => {
	document.getElementById('previewBox').appendChild(genImgFromSrc(src))
}


  // Declare the Customizable callback function
  const myCallback = (loadedData) => {
	// Remember that the results come back as an array of Objects with Content/Errors AND Metadata
		console.log(loadedData) // Checkout the returned Data in it's raw form
	
		loadedData.forEach(f => {
			const { err, category, name, plaintext, encoded } = f
			if(err){
				console.error(err)
			}

			if(category == 'text' && plaintext !== null ){
				document.getElementById('textout').innerText += `${plaintext}\n`
			}

			if(category == 'image' && encoded !== null){
				preview(encoded)
			}
		})
  }

  // Instantiate and Use Syntactic Sugar for a File Drop
  new EasyListener("drop_zone", myCallback, 'text').fileDropListener();

  // Instantiate and Use Syntactic Sugar for a File Input Button
  new EasyListener("fileButton", myCallback, 'text').fileButtonListener();

  </script>
</body>
</html>